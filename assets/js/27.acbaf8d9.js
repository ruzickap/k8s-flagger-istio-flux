(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{327:function(a,e,s){"use strict";s.r(e);var t=s(8),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"install-flagger"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-flagger"}},[a._v("#")]),a._v(" Install Flagger")]),a._v(" "),e("p",[a._v("Add Flagger Helm repository:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("helm repo "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" flagger https://flagger.app\n")])])]),e("p",[a._v("Output:")]),a._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('"flagger" has been added to your repositories\n')])])]),e("p",[a._v("Install Flagger's custom resource definitions:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("kubectl apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" https://raw.githubusercontent.com/weaveworks/flagger/master/artifacts/flagger/crd.yaml\n")])])]),e("p",[a._v("Output:")]),a._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("customresourcedefinition.apiextensions.k8s.io/canaries.flagger.app created\n")])])]),e("p",[a._v("To install the chart with the release name "),e("code",[a._v("flagger")]),a._v(" for Istio:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("helm "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" flagger "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("istio-system flagger/flagger "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.18")]),a._v(".4 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--wait")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("crd.create")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"false"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("logLevel")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"debug"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("meshProvider")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"istio"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("metricsServer")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://prometheus:9090"')]),a._v("\n")])])]),e("p",[a._v("Output:")]),a._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("NAME:   flagger\nLAST DEPLOYED: Thu Sep 19 08:22:43 2019\nNAMESPACE: istio-system\nSTATUS: DEPLOYED\n\nRESOURCES:\n==> v1/Deployment\nNAME     READY  UP-TO-DATE  AVAILABLE  AGE\nflagger  1/1    1           1          20s\n\n==> v1/Pod(related)\nNAME                      READY  STATUS   RESTARTS  AGE\nflagger-78957f5cf9-xxsb7  1/1    Running  0         20s\n\n==> v1/ServiceAccount\nNAME     SECRETS  AGE\nflagger  1        20s\n\n==> v1beta1/ClusterRole\nNAME     AGE\nflagger  20s\n\n==> v1beta1/ClusterRoleBinding\nNAME     AGE\nflagger  20s\n\n\nNOTES:\nFlagger installed\n")])])]),e("p",[a._v("Install Flagger's Grafana Helm Release:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("helm "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" flagger-grafana "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--namespace")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("istio-system flagger/grafana "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.3")]),a._v(".0 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("admin "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://prometheus:9090 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--set")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("admin\n")])])]),e("p",[a._v("Output:")]),a._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("NAME:   flagger-grafana\nLAST DEPLOYED: Thu Sep 19 08:23:36 2019\nNAMESPACE: istio-system\nSTATUS: DEPLOYED\n\nRESOURCES:\n==> v1/ConfigMap\nNAME                         DATA  AGE\nflagger-grafana-dashboards   2     0s\nflagger-grafana-datasources  1     0s\nflagger-grafana-providers    1     0s\n\n==> v1/Pod(related)\nNAME                              READY  STATUS             RESTARTS  AGE\nflagger-grafana-66ffcb79b6-rbwpn  0/1    ContainerCreating  0         0s\n\n==> v1/Service\nNAME             TYPE       CLUSTER-IP    EXTERNAL-IP  PORT(S)  AGE\nflagger-grafana  ClusterIP  10.0.145.140  &lt;none>       80/TCP   0s\n\n==> v1beta2/Deployment\nNAME             READY  UP-TO-DATE  AVAILABLE  AGE\nflagger-grafana  0/1    1           0          0s\n\n\nNOTES:\n1. Run the port forward command:\n\nkubectl -n istio-system port-forward svc/flagger-grafana 3000:80\n\n2. Navigate to:\n\nhttp://localhost:3000\n")])])]),e("p",[a._v("Expose "),e("code",[a._v("flagger-grafana")]),a._v(" outside:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),e("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" kubectl apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" -")]),a._v("\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: flagger-grafana-gateway\n  namespace: istio-system\nspec:\n  selector:\n    istio: ingressgateway\n  servers:\n  - port:\n      number: 80\n      name: http-flagger-grafana\n      protocol: HTTP\n    hosts:\n    - flagger-grafana."),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n  - port:\n      number: 443\n      name: https-flagger-grafana\n      protocol: HTTPS\n    hosts:\n    - flagger-grafana."),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n    tls:\n      credentialName: ingress-cert-"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${LETSENCRYPT_ENVIRONMENT}")]),a._v("\n      mode: SIMPLE\n      privateKey: sds\n      serverCertificate: sds\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: flagger-grafana-virtual-service\n  namespace: istio-system\nspec:\n  hosts:\n  - flagger-grafana."),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n  gateways:\n  - flagger-grafana-gateway\n  http:\n  - route:\n    - destination:\n        host: flagger-grafana.istio-system.svc.cluster.local\n        port:\n          number: 80\nEOF")]),a._v("\n")])])]),e("p",[a._v("Output:")]),a._v(" "),e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("gateway.networking.istio.io/flagger-grafana-gateway created\nvirtualservice.networking.istio.io/flagger-grafana-virtual-service created\n")])])]),e("p",[a._v("The Grafana with Flagger dashboards should be here: "),e("a",{attrs:{href:"https://flagger-grafana.myexample.dev",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://flagger-grafana.myexample.dev"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);